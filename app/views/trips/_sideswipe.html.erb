      <div class="triptitlebox">

        <p>
        <span class="trip-title-main-text"><%= @trip.trip_name %></span>
        <span class="trip-title-sub-text"> - Day X of <%= @trip.duration %> in London</span>
        </p>
        <small>by <%= @trip.author_id %> <i class="icon-heart-empty icon-1x"></i> [000] Likes</small>
      
      <div class="socialmediabox">
      <i class="icon-pinterest-sign icon-2x"></i>
      <i class="icon-facebook-sign icon-2x"></i>
      <i class="icon-twitter-sign icon-2x"></i>
      </div>

      <label for="main-nav-check" class="toggle-menu">
      <i class="icon-reorder icon-border"></i>
      </label>

      </div>
      
      <div class="filmstrip">
        
        <ul class="media-list" id="navswipe">
          <li class="media selected" onclick="gallery.goToPage(0)">
            <img class="media-object" data-src="holder.js/160x120">
          </li>
          <% for i  in 1..(trip_activities_as_json.count('{')-1) %>
            <li class="media" onclick="gallery.goToPage(<%= i %>)">
              <img class="media-object" data-src="holder.js/160x120">
            </li>
          <% end %> 

        </ul>
      </div>

  <div id="wrapper"></div>

<%= trip_activities_as_json %>
<!-- /bottom navigation bar -->
      <div class="bottomnavigationbar" id="leftnavigation" onclick="gallery.prev()"><i class="icon-chevron-left icon-2x"></i></div>
      
      <div class="bottomnavigationbar" id="previousstepbox">
        
        [Go Back]
        
        </br>[How and Time]</div>
      
      <div class="bottomnavigationbar" id="nextstepbox">
        
        [Go Next]

      </br>[How and Time]</div>
      
      <div class="bottomnavigationbar" id="rightnavigation" onclick="gallery.next()"  ><i class="icon-chevron-right icon-2x"></i></div>

<!-- /sliding panel -->        
<div id="wrapperhung">
          <div id="lower">

            <div id="bar"><a href="#" id="toggle">More Info</a></div>

            <div id="panel">
                <p>Panel - Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean a mauris et nulla facilisis eleifend. Sed metus orci, vulputate sit amet malesuada id, luctus vestibulum lacus. Sed faucibus, nibh vel faucibus porta, lectus lacus suscipit metus, ut posuere nulla dolor porttitor erat. Nam iaculis dolor et est tristique scelerisque. Integer gravida scelerisque est, ut pellentesque sem facilisis in. Quisque felis elit, laoreet id sagittis non, sollicitudin vitae turpis. Pellentesque quis quam sed nibh sollicitudin porttitor non ac sapien. Cras luctus egestas urna, vitae bibendum enim malesuada ut. Nulla porta tempus mi vel consequat. Aenean scelerisque porttitor felis, id elementum erat porttitor eu. Mauris vitae elit non lorem malesuada viverra non ac eros.</p>
                <p>Panel - Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean a mauris et nulla facilisis eleifend. Sed metus orci, vulputate sit amet malesuada id, luctus vestibulum lacus. Sed faucibus, nibh vel faucibus porta, lectus lacus suscipit metus, ut posuere nulla dolor porttitor erat. Nam iaculis dolor et est tristique scelerisque. Integer gravida scelerisque est, ut pellentesque sem facilisis in. Quisque felis elit, laoreet id sagittis non, sollicitudin vitae turpis. Pellentesque quis quam sed nibh sollicitudin porttitor non ac sapien. Cras luctus egestas urna, vitae bibendum enim malesuada ut. Nulla porta tempus mi vel consequat. Aenean scelerisque porttitor felis, id elementum erat porttitor eu. Mauris vitae elit non lorem malesuada viverra non ac eros.</p>
            </div>

        </div>
</div>

<script type="text/javascript">
//removing this line per cubiq.org/swipeview comment to re-enable vertical scroll
// document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);

var gallery,
  el,
  i,
  page,
  dots = document.querySelectorAll('#navswipe li'),
  dots2 = document.querySelectorAll('#navswipe2 li'),
  slides = <%= trip_activities_as_json.html_safe %> //this returns an array of hashes formatted in trip_helper.rb
  ;

gallery = new SwipeView('#wrapper', { numberOfPages: slides.length });

// Load initial data
for (i=0; i<3; i++) {
  page = i==0 ? slides.length-1 : i-1;
 
  $.ajax({
    type: 'GET',
    url: slides[page].renderpartial,
    data: {activityid: slides[page].activityid, layout: slides[page].layout},
    ajaxI: i, // Capture the current value of 'i'
    dataType: 'html',
    success: function(data){
      $(gallery.masterPages[this.ajaxI]).append(data);
    }
  });

  //I added to change text of trip-title-sub-text Day x of X in Location
  document.querySelector('span.trip-title-sub-text').innerHTML = 'Day '+ slides[gallery.pageIndex].activityday + ' of ' + slides[gallery.pageIndex].triplength + ' in ' + slides[gallery.pageIndex].triplocation ;
}

gallery.onFlip(function () {
  var el,
    del,
    eel,
    upcoming,
    i;

  for (i=0; i<3; i++) {
    upcoming = gallery.masterPages[i].dataset.upcomingPageIndex;

    if (upcoming != gallery.masterPages[i].dataset.pageIndex) {

      $.ajax({
        type: 'GET',
        url: slides[upcoming].renderpartial,
        data: {activityid: slides[upcoming].activityid, layout: slides[upcoming].layout},
        ajaxI: i, // Capture the current value of 'i'
        dataType: 'html',
        success: function(data){
          $(gallery.masterPages[this.ajaxI]).html(data);
        }
      });
    }
  }

  document.querySelector('#navswipe .selected').className = '';
  dots[gallery.pageIndex].className = 'selected';
  document.querySelector('#navswipe2 .selected').className = '';
  dots2[gallery.pageIndex].className = 'selected';

  //I added to change text of trip-title-sub-text Day x of X in Location
  document.querySelector('span.trip-title-sub-text').innerHTML = 'Day '+ slides[gallery.pageIndex].activityday + ' of ' + slides[gallery.pageIndex].triplength + ' in ' + slides[gallery.pageIndex].triplocation ;
});

gallery.onMoveOut(function () {
  gallery.masterPages[gallery.currentMasterPage].className = gallery.masterPages[gallery.currentMasterPage].className.replace(/(^|\s)swipeview-active(\s|$)/, '');
});

gallery.onMoveIn(function () {
  var className = gallery.masterPages[gallery.currentMasterPage].className;
  /(^|\s)swipeview-active(\s|$)/.test(className) || (gallery.masterPages[gallery.currentMasterPage].className = !className ? 'swipeview-active' : className + ' swipeview-active');
});

</script>