<!-- Begin Trip Details Form Container -->
<div class="publish_trip_details_container">
  <%= form_for @trip, :url => @trip_publish, :html => {:class => "form-horizontal", :multipart => true} do |f| %>
  
    <% if @trip.errors.any? %>
      <div id="error_explanation">
        <ul>      
          <% @trip.errors.messages.each do |attr, msg| %>
            <li><%= msg.first %></li>
          <% end %>
        </ul>      
      </div>
    <% end %>

    <%= f.hidden_field :image_url, :class => "selected_images" %>
    <%= hidden_field_tag :latlong, @latlong %>
    <%= hidden_field_tag :locationval, @location_val %>

    <div class="field">
      <%= f.hidden_field :location_id %>
    </div>

    <div class="control-group">
      <label class="control-label">Where did you go? <span class="required_star">*</span></label>
      <div class="controls">
        <% if controller.action_name == "publish_new" %>
          <input id="place_text_field" type="text" name="location" value="<%= @location_val %>" placeholder = "Input a city (i.e. San Francisco)" class = "span3 required_publish_form_field">
          <span class ="help-inline publish_form_required_label">Required</span>
        <% else %>
          <span class="control-label"><strong><%= @location_val %></strong></span>
        <% end %>
      </div>
    </div>

    <div class="control-group">
      <label class="control-label">Who is this best for? <span class="required_star">*</span></label>
      <div class = "controls">
        <%= f.collection_select :traveler_type_id, TravelerType.find(:all, :limit => 4), :traveler_type_id, :traveler_type_name,{:prompt => 'Traveler Type'}, :class => "span3" %>
        <span class ="help-inline publish_form_required_label">Required</span>
      </div>
    </div>

    <div class="control-group">
      <label class="control-label">Add a cover picture</label>
      <div class="controls">
          <%# f.file_field :self_image %>
        <!-- Begin Select an Image Wrapper -->
        <div class = "td_select_an_image_div">
          <!-- Begin Uploaded Image Preview -->
          <div class = "uploaded_image_preview">
            <% if !@trip.self_image.blank? %>
              <div class = "yes_upload_div" id = "yes_upload_div">
                <%= image_tag(@trip.self_image_url(:thumb), :class => "pt_activity_upload_img") %>
              </div>
            <% elsif !@trip.self_image_tmp.blank? %>
              <div class = "no_upload_div">
                <i class = "icon-spinner icon-2x"></i>
                </br>
                <strong>We're processing the image that you have uploaded.</strong>
              </div> 
            <% else %>
              <div class = "no_upload_div">
                <i class = "icon-picture icon-4x"></i>
                </br>
                <strong>Add your own image or grab one from Foursquare.</strong>
              </div>
            <% end %>
          </div>
          <!-- End Uploaded Image Preview -->

          <!-- Begin Upload Field -->
          <p class="pt_upload_field form-horizontal">
            <input type="text" class="pt_upload_path" />
            <label class="pt_upload_button btn-flat btn-flat-primary">
              Upload
              <span>
                <%= f.file_field :self_image, :class => "pt_upload_file"%>
             </span>
           </label>
          </p>
          <!-- End Upload Field -->
      </div>
      <!-- End Select an Image Wrapper -->
          <button class = "btn-flat btn-flat-block btn-flat-info trip_cover_pick_foursquare_btn">Select From Foursquare</button>
      </div>

    </div> 
    
    <hr class = "publish_form_hr">
   
    <div class = "pt_gray_box">
      <span class ="help-inline publish_form_required_label">
        You'll have another chance to edit the following before publishing.
      </span>
      <br><br>
      <%= render 'shared/publish/publish_trip_confirm_form', :f => f %>
    </div>

    <div class="control-group">
      <div class="controls">
        <%= f.submit @trip_message, :name => @trip_name, :id => "trip_form_submit", :class => "btn-flat btn-flat-success btn-flat-large pull-right" %>
      </div>
    </div>

  <% end %>

</div>
<!-- End Trip Details Form Container -->