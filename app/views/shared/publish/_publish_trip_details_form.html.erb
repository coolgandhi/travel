<!-- Begin Trip Details Form Container -->
<div class="publish_trip_details_container">
  <%= form_for @trip, :url => @trip_publish, :html => {:class => "form-horizontal", :multipart => true} do |f| %>
  
    <% if @trip.errors.any? %>
      <div id="error_explanation">
        <ul>      
          <% @trip.errors.messages.each do |attr, msg| %>
            <li><%= msg.first %></li>
          <% end %>
        </ul>      
      </div>
    <% end %>

    <%= f.hidden_field :image_url, :class => "selected_images" %>
    <%= hidden_field_tag :latlong, @latlong %>
    <%= hidden_field_tag :locationval, @location_val %>

    <div class="field">
      <%= f.hidden_field :location_id %>
    </div>
             
    <div class="control-group">
      <label class="control-label">Where did you go? <span class="required_star">*</span></label>
      <div class="controls">
        <% if controller.action_name == "publish_new" %>

          <%= select_tag :publish_place_dropdown_field, options_from_collection_for_select(Location.find(:all, :limit => 3), "location_id", "location_label", params[:place]), :multiple => false, :prompt => "Which city?", :class => "publish_place_dropdown_field" %>

          <!-- <input id="place_text_field" type="text" name="location" value="<%= @location_val %>" placeholder = "Input a city (i.e. San Francisco)" class = "span3 required_publish_form_field"> -->

          <!-- <span class ="help-inline publish_form_required_label">Required</span> -->
        <% else %>
          <span class="control-label"><strong><%= @location_val %></strong></span>
        <% end %>
      </div>
    </div>

    <div class="control-group">
      <label class="control-label">Who is this best for? <span class="required_star">*</span></label>
      <div class = "controls">
        <%= f.collection_select :traveler_type_id, TravelerType.find(:all, :limit => 4), :traveler_type_id, :traveler_type_name,{:prompt => 'Traveler Type'}, :class => "span3" %>
        <!-- <span class ="help-inline publish_form_required_label">Required</span> -->
      </div>
    </div>

    <div class="control-group">
      <label class="control-label">Add a cover picture</label>
      <div class="controls">
          <%# f.file_field :self_image %>
        <!-- Begin Select an Image Wrapper -->
        <div class = "td_select_an_image_div upload_pic_parent_box">
          <% use_this_url, which_url_msg = upload_or_foursquare_image_url_picker(@trip) %>
          <div class = "uploaded_image_msg"><%= which_url_msg %></div>
          <!-- Begin Uploaded Image Preview -->
          <div class = "uploaded_image_preview">
            <div class = "yes_upload_div" id = "yes_upload_div">  
              <%= image_tag(use_this_url, :class => "pt_activity_upload_img") %>
            </div>
          </div>
          <!-- End Uploaded Image Preview -->

          <!-- Begin Upload Field -->
          <p class="pt_upload_field form-horizontal">
            <input type="text" class="pt_upload_path" />
            <label class="pt_upload_button btn-flat btn-flat-primary">
              Upload
              <span>
                <%= f.file_field :self_image, :class => "pt_upload_file"%>
             </span>
           </label>
          </p>
          <!-- End Upload Field -->
          <p class = "p_upload_or_foursquare">&#8212; or &#8212;</p>
          <% if !@trip.image_url.blank? %>
           <button class = "btn-flat btn-flat-block btn-flat-warning trip_cover_pick_foursquare_btn">Foursquare Image Selected</button>
          <% else %>
            <button class = "btn-flat btn-flat-block btn-flat-info trip_cover_pick_foursquare_btn">Select From Foursquare</button>
          <% end %>

      </div>
      <!-- End Select an Image Wrapper -->
          
      </div>

    </div> 
    
    <hr class = "publish_form_hr">
   
    <div class = "pt_gray_box">
      <span class ="help-inline publish_form_required_label">
        You'll have another chance to edit the following before publishing.
      </span>
      <br><br>
      <%= render 'shared/publish/publish_trip_confirm_form', :f => f %>
    </div>

    <div class="control-group">
      <div class="controls">
        <%= f.submit @trip_message, :name => @trip_name, :id => "trip_form_submit", :class => "btn-flat btn-flat-success btn-flat-large pull-right" %>
      </div>
    </div>

  <% end %>

</div>
<!-- End Trip Details Form Container -->