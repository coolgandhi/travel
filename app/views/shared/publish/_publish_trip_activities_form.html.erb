<!-- Begin Trip Activities Form Container -->
<div class="publish_trip_activities_container">
  <% if ((@trip_activity and @trip_activity.errors.any?) or (@activity and @activity.errors.any?) or (@activity_detail and @activity_detail.errors.any?)) %>
    <div id="error_explanation">
      <h2><%#= pluralize(@trip_activity.errors.count, "error") %> prohibited this activity from being saved:</h2>

      <ul>
        <% if @trip_activity %>
          <% @trip_activity.errors.messages.each do |attr, msg| %>
            <li><%= msg.first %></li>
          <% end %>
        <% end %>
        <% if @activity %>
          <% @activity.errors.messages.each do |attr, msg| %>
            <li><%= msg.first %></li>
          <% end %>
        <% end %>
        <% if @activity_detail %>
          <% @activity_detail.errors.messages.each do |attr, msg| %>
            <li><%= msg.first %></li>
          <% end %>
        <% end %>
      </ul>
    </div>
  <% end %>
  
  <span class="pt_activity_edit_or_create_title">
    <%= controller.action_name == "publish_trip_activity_edit" ? "Edit Day #{@trip_activity.activity_day} Activity" : "Create Day #{params[:day]} Activity" %>
  </span>
  <hr class = "publish_form_hr">
  <% if controller.action_name == "publish_trip_activity_new" %>
    <div class = "fields_inline">
      <input id="activityvenue" type="text" name="activityvenue" placeholder="Search name of Activity (i.e. Statue of Liberty)" value="" autofocus = true />
    </div>
    </br>
  <% end %>

      <!--specifying the url allows for specifying which action in the trip_activities controller to hit -->
      <%= form_for([@trip, @trip_activity], :url => @update == 0 ? publish_trip_activity_create_trip_trip_activities_url(:trip_id => @trip.id) : publish_trip_activity_update_trip_trip_activity_url(:trip_id => @trip.id), :html => {:multipart => true, :class => "pt_trip_activity_form"}) do |f| %>        

        <!-- Begin Activity Confirm Box -->
        <div class = "form_activity_confirm_box" >

          <%= render "shared/publish/publish_confirm_venue_box" %>  
          <div class ="publish_trip_activity_pic_select">

            <!-- Begin Uploaded Image Preview -->
            <div class = "uploaded_image_preview">
              <% if !@trip_activity.self_trip_activity_photos.first.blank? and !@trip_activity.self_trip_activity_photos.first.self_photo.blank? %>
                <div class = "yes_upload_div" id = "yes_upload_div">
                  <%= image_tag(@trip_activity.self_trip_activity_photos.first.self_photo_url(:thumb), :class => "pt_activity_upload_img") %>
                </div>
              <% elsif !@trip_activity.self_trip_activity_photos.first.blank? and !@trip_activity.self_trip_activity_photos.first.self_photo_tmp.blank? %>
                <div class = "no_upload_div">
                  <i class = "icon-spinner icon-4x"></i>
                  </br>
                  <strong>We're processing the image that you have uploaded.</strong>
                </div>               
              <% else %>
                <div class = "no_upload_div">
                  <i class = "icon-picture icon-4x"></i>
                  </br>
                  <strong>Add your own image or we'll grab one from Foursquare.</strong>
                </div>  
              <% end %>
            </div>
            <!-- End Uploaded Image Preview -->

            <div class = "publish_trip_upload_field">
              <%= fields_for @trip_activity.self_trip_activity_photos.new do |trip_image| %>
                <!-- Begin Upload Field -->
                <p class="pt_upload_field form-horizontal">
                  <input type="text" class="pt_upload_path" />
                  <label class="pt_upload_button btn-flat btn-flat-primary">
                    Choose
                    <span> 
                      <%= trip_image.file_field :self_photo, :name => "self_trip_activity_photos[self_photo]", :class => "pt_upload_file"%>
                   </span>
                 </label>
                </p> 
                <!-- End Upload Field -->
              <% end %>
            </div>



          </div>
        </div>
        <!-- End Activity Confirm Box -->

        <%= hidden_field_tag :trip_activity_latlong, @latlong %>
        <%= hidden_field_tag :trip_id, @trip_activity.trip_id %>
        <%= f.hidden_field :activity_day, :value => @trip_activity.activity_day.blank? ? '1' : @trip_activity.activity_day %>
        <%= f.hidden_field :activity_time_type,  :value => @trip_activity.activity_time_type.blank? ? '1' : @trip_activity.activity_time_type %>
        <%# f.hidden_field :activity_sequence_number %>
        <%#= f.hidden_field :activity_day, :value => params[:trip_activity].nil? and params[:trip_activity][:activity_day].nil? ? '1' : params[:trip_activity][:activity_day] %> 
        <%#= f.hidden_field :activity_time_type,  :value =>  params[:trip_activity][:activity_time_type].nil? ? '1' : params[:trip_activity][:activity_time_type] %>
        <input type="hidden" id="venue_id" name="venueid" value=<%= params[:venueid].nil?  ? '' : params[:venueid] %> >
          
          <label><strong>Short Description<span class="required_star">*</span></strong></label>
          <textarea rows="4" name="description" placeholder="User Description" class="publish_form_user_description word_count" maxcharacters="200"><%= params[:description].nil?  ? '' : params[:description] %></textarea>
          <p class ="counter"></p>

          <div class = "pt_form_bg">
            <label class = "checkbox">
              <%= f.check_box :cant_miss, :class => "checkbox"  %>
              You definitely should not miss this activity
            </label>
          </div>
          
          <label><strong>Quick Tip</strong></label>
          <textarea rows="3" name="quick_tip" placeholder="Quick Tip" class="publish_form_quicktip word_count" maxcharacters="140"><%= params[:quick_tip].nil?  ? '' : params[:quick_tip] %></textarea>
          <p class ="counter"></p>

          <!-- Begin Duration Field-->
          <label><strong>Time Spent Here</strong></label>
          <select name="duration">
              <!-- <option>How much time?</option> -->
              <% ActivityDurationType.all.each do |activity| %>
                <option value="<%= activity.activity_duration_type_id %>" <%= params[:duration] == activity.activity_duration_type_id  ? "selected" : "" %> >
                  <%= activity.activity_duration_name %>
                </option>
              <% end %>
          </select>
          <!-- End Fields Inline -->

          <div class="control-group">
            <div class="error_msg"></div>
            <div class="controls">
              <input type="button" class="btn-flat btn-flat-success pull-right" id="trip_activity_form_button" value="<%= controller.action_name == "publish_trip_activity_new" ? 'Add Activity' : 'Save Changes' %>" />
            </div>
          </div>
          

        </fieldset>        

      <% end %>
      <button class = "btn-flat ta_pick_from_foursquare">Pic from 4SQ</button>
</div>
<!-- Begin Trip Activities Form Container -->
